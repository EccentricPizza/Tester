<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eccentric Pizza Pre-Order</title>
<style>
    body { font-family: Arial, sans-serif; background-color: #fff8f0; color: #4a0000; margin:0; padding:0; }
    header { background-color: #4a0000; color: #fff8f0; padding: 1rem; text-align: center; }
    h1 { margin:0; }
    main { padding: 1rem; max-width: 600px; margin:auto; }
    label { display:block; margin-top: 0.5rem; }
    input, select, textarea { width: 100%; padding: 0.5rem; margin-top:0.2rem; }
    button { background-color: #4a0000; color: #fff8f0; border: none; padding: 1rem; margin-top: 1rem; width: 100%; font-size: 1rem; cursor: pointer; }
    button:hover { opacity:0.9; }
    .section { margin-top: 2rem; padding: 1rem; background-color: #fff0e0; border-radius: 8px; }
    .admin-section { margin-top:2rem; background-color:#ffe0e0; padding:1rem; border-radius:8px;}
    table { width:100%; border-collapse: collapse; margin-top:1rem;}
    th, td { border:1px solid #4a0000; padding:0.5rem; text-align:left; }
</style>
</head>
<body>
<header>
    <h1>Eccentric Pizza Pre-Orders</h1>
</header>
<main>
<form id="orderForm">
    <div class="section">
        <h2>Customer Info</h2>
        <label for="name">Name *</label>
        <input type="text" id="name" required>
        <label for="phone">Phone *</label>
        <input type="text" id="phone" required>
        <label for="email">Email (optional)</label>
        <input type="email" id="email">
        <label for="notes">Special Notes</label>
        <textarea id="notes" rows="2"></textarea>
    </div>

    <div class="section">
        <h2>Pickup Location</h2>
        <select id="location" required onchange="updateTimes()">
            <option value="">-- Select Location --</option>
            <option value="Permanent">Eccentric Limavady, Connell Street</option>
            <option value="Popup">Pop-Up Event</option>
        </select>
    </div>

    <div class="section">
        <h2>Pickup Time</h2>
        <select id="pickupTime" required></select>
    </div>

    <div class="section">
        <h2>Menu</h2>
        <label>Margherita (£9) <input type="number" min="0" value="0" id="margherita"></label>
        <label>Pepperoni (£10) <input type="number" min="0" value="0" id="pepperoni"></label>
        <label>Fungi (£9.50) <input type="number" min="0" value="0" id="fungi"></label>
        <label>A Sweet Chick (£10.50) <input type="number" min="0" value="0" id="sweetchick"></label>
        <label>Hawaiian (£10.50) <input type="number" min="0" value="0" id="hawaiian"></label>
        <label>Carni (£12) <input type="number" min="0" value="0" id="carni"></label>
        <label>Garlic Bread (£8) <input type="number" min="0" value="0" id="garlicbread"></label>
    </div>

    <button type="submit">Submit Order</button>
</form>

<div class="admin-section">
    <h2>Admin Orders (Latest)</h2>
    <table id="adminTable">
        <thead>
            <tr>
                <th>Timestamp</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Location</th>
                <th>Pickup Time</th>
                <th>Order</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
// Pickup times for locations
const times = {
    "Permanent": generateTimes("16:00","21:00",10), // Thursday-Sunday
    "Popup": generateTimes("16:00","20:30",10)
};

function generateTimes(start, end, intervalMinutes){
    let times = [];
    let [sh, sm] = start.split(":").map(Number);
    let [eh, em] = end.split(":").map(Number);
    while(sh<eh || (sh===eh && sm<=em)){
        let h = sh.toString().padStart(2,'0');
        let m = sm.toString().padStart(2,'0');
        times.push(`${h}:${m}`);
        sm += intervalMinutes;
        if(sm>=60){ sh++; sm-=60; }
    }
    return times;
}

function updateTimes(){
    const loc = document.getElementById("location").value;
    const timeSelect = document.getElementById("pickupTime");
    timeSelect.innerHTML = "<option value=''>-- Select Time --</option>";
    if(loc && times[loc]){
        times[loc].forEach(t=>{
            let opt = document.createElement("option");
            opt.value = t; opt.textContent = t;
            timeSelect.appendChild(opt);
        });
    }
}

// Orders array
let orders = [];

document.getElementById("orderForm").addEventListener("submit", function(e){
    e.preventDefault();
    const order = {
        timestamp: new Date().toLocaleString(),
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        location: document.getElementById("location").value,
        pickupTime: document.getElementById("pickupTime").value,
        items: [
            {item:"Margherita", qty:document.getElementById("margherita").value},
            {item:"Pepperoni", qty:document.getElementById("pepperoni").value},
            {item:"Fungi", qty:document.getElementById("fungi").value},
            {item:"A Sweet Chick", qty:document.getElementById("sweetchick").value},
            {item:"Hawaiian", qty:document.getElementById("hawaiian").value},
            {item:"Carni", qty:document.getElementById("carni").value},
            {item:"Garlic Bread", qty:document.getElementById("garlicbread").value}
        ].filter(i=>i.qty>0),
        notes: document.getElementById("notes").value
    };
    orders.push(order);
    updateAdminTable();
    alert("Order submitted! Thank you.");
    document.getElementById("orderForm").reset();
    document.getElementById("pickupTime").innerHTML = "<option value=''>-- Select Time --</option>";
});

function updateAdminTable(){
    const tbody = document.querySelector("#adminTable tbody");
    tbody.innerHTML = "";
    // Sort by pickup time
    const sorted = orders.sort((a,b)=>{
        if(a.location===b.location) return a.pickupTime.localeCompare(b.pickupTime);
        return a.location.localeCompare(b.location);
    });
    sorted.forEach(o=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${o.timestamp}</td>
        <td>${o.name}</td>
        <td>${o.phone}</td>
        <td>${o.email}</td>
        <td>${o.location}</td>
        <td>${o.pickupTime}</td>
        <td>${o.items.map(i=>i.item+" x"+i.qty).join(", ")}</td>
        <td>${o.notes}</td>`;
        tbody.appendChild(tr);
    });
}
</script>
</body>
</html>
