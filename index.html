<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eccentric Pizza Pre-Order</title>
<style>
    body { font-family: Arial, sans-serif; background-color: #fff8f0; color: #4a0000; margin:0; padding:0; }
    header { background-color: #4a0000; color: #fff8f0; padding: 1rem; text-align: center; }
    h1 { margin:0; }
    main { padding: 1rem; max-width: 600px; margin:auto; }
    label { display:block; margin-top: 0.5rem; }
    input, select, textarea { width: 100%; padding: 0.5rem; margin-top:0.2rem; }
    button { background-color: #4a0000; color: #fff8f0; border: none; padding: 1rem; margin-top: 1rem; width: 100%; font-size: 1rem; cursor: pointer; }
    button:hover { opacity:0.9; }
    .section { margin-top: 2rem; padding: 1rem; background-color: #fff0e0; border-radius: 8px; }
    .admin-section { margin-top:2rem; background-color:#ffe0e0; padding:1rem; border-radius:8px;}
    table { width:100%; border-collapse: collapse; margin-top:1rem;}
    th, td { border:1px solid #4a0000; padding:0.5rem; text-align:left; }
</style>
</head>
<body>
<header>
    <h1>Eccentric Pizza Pre-Orders</h1>
</header>
<main>
<form id="orderForm">
    <div class="section">
        <h2>Customer Info</h2>
        <label for="name">Name *</label>
        <input type="text" id="name" required>
        <label for="phone">Phone *</label>
        <input type="text" id="phone" required>
        <label for="email">Email (optional)</label>
        <input type="email" id="email">
        <label for="notes">Special Notes</label>
        <textarea id="notes" rows="2"></textarea>
    </div>

    <div class="section">
        <h2>Pickup Location</h2>
        <select id="location" required onchange="updateTimes()">
            <option value="">-- Select Location --</option>
            <option value="Permanent">Eccentric Limavady, Connell Street</option>
            <option value="Popup">Pop-Up Event</option>
        </select>
    </div>

    <div class="section">
        <h2>Pickup Time</h2>
        <select id="pickupTime" required></select>
    </div>

    <div class="section">
        <h2>Menu</h2>
        <label>Margherita (£9) <input type="number" min="0" value="0" id="margherita"></label>
        <label>Pepperoni (£10) <input type="number" min="0" value="0" id="pepperoni"></label>
        <label>Fungi (£9.50) <input type="number" min="0" value="0" id="fungi"></label>
        <label>A Sweet Chick (£10.50) <input type="number" min="0" value="0" id="sweetchick"></label>
        <label>Hawaiian (£10.50) <input type="number" min="0" value="0" id="hawaiian"></label>
        <label>Carni (£12) <input type="number" min="0" value="0" id="carni"></label>
        <label>Garlic Bread (£8) <input type="number" min="0" value="0" id="garlicbread"></label>
    </div>

    <button type="submit">Submit Order</button>
</form>

<div class="admin-section">
    <h2>Admin Orders (Latest)</h2>
    <table id="adminTable">
        <thead>
            <tr>
                <th>Timestamp</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Location</th>
                <th>Pickup Time</th>
                <th>Order</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
// Menu items and their prices
const menuItems = [
    { id: "margherita", name: "Margherita", price: 9 },
    { id: "pepperoni", name: "Pepperoni", price: 10 },
    { id: "fungi", name: "Fungi", price: 9.5 },
    { id: "sweetChick", name: "A Sweet Chick", price: 10.5 },
    { id: "hawaiian", name: "Hawaiian", price: 10.5 },
    { id: "carni", name: "Carni", price: 12 },
    { id: "garlicBread", name: "Garlic Bread", price: 8 }
];

// Timeslots generation (every 10 mins from 16:00-20:30, excluding 16:00 and 21:00)
function generateTimes(start, end, intervalMinutes){
    let times = [];
    let [sh, sm] = start.split(":").map(Number);
    let [eh, em] = end.split(":").map(Number);
    while(sh<eh || (sh===eh && sm<=em)){
        let h = sh.toString().padStart(2,'0');
        let m = sm.toString().padStart(2,'0');
        let currentTime = `${h}:${m}`;
        if(currentTime !== "16:00" && currentTime !== "21:00") {
            times.push(currentTime);
        }
        sm += intervalMinutes;
        if(sm>=60){ sh++; sm-=60; }
    }
    return times;
}

// Populate pickup times based on location
const pickupTimes = generateTimes("16:00","20:30",10);
const pickupSelect = document.getElementById("pickupTime");

function updateTimes() {
    pickupSelect.innerHTML = '<option value="">Select Time</option>'; // reset
    pickupTimes.forEach(time => {
        let opt = document.createElement("option");
        opt.value = time;
        opt.textContent = time;
        pickupSelect.appendChild(opt);
    });
}

// Initialize times
updateTimes();

// Orders storage
let orders = [];

// Submit order
document.getElementById("orderForm").addEventListener("submit", function(e){
    e.preventDefault();

    let order = {
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        date: document.getElementById("orderDate").value,
        location: document.getElementById("location").value,
        time: pickupSelect.value,
        items: menuItems.map(item => {
            return { name: item.name, quantity: Number(document.getElementById(item.id).value), price: item.price };
        }).filter(i => i.quantity > 0)
    };

    if(!order.time || !order.date || !order.location || !order.items.length){
        alert("Please fill out all required fields and select at least one item.");
        return;
    }

    orders.push(order);
    displayOrders();

    // Remove chosen timeslot
    let selectedIndex = pickupSelect.selectedIndex;
    if(selectedIndex > 0){
        pickupSelect.remove(selectedIndex);
    }

    this.reset();
});

// Display orders in admin table
function displayOrders(){
    const tbody = document.getElementById("adminTableBody");
    tbody.innerHTML = "";
    orders.forEach(o => {
        let row = document.createElement("tr");
        row.innerHTML = `
            <td>${o.name}</td>
            <td>${o.phone}</td>
            <td>${o.date}</td>
            <td>${o.location}</td>
            <td>${o.time}</td>
            <td>${o.items.map(i => `${i.name} x${i.quantity}`).join(", ")}</td>
        `;
        tbody.appendChild(row);
    });
}
</script>

</body>
</html>

